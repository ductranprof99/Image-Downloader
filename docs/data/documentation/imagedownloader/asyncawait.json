{"abstract":[{"type":"text","text":"Use modern Swift concurrency with async\/await APIs."}],"sections":[],"kind":"article","identifier":{"interfaceLanguage":"swift","url":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/AsyncAwait"},"seeAlsoSections":[{"identifiers":["doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/GettingStarted","doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/Configuration"],"anchor":"Essentials","title":"Essentials","generated":true}],"hierarchy":{"paths":[["doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader"]]},"topicSections":[{"identifiers":["doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderManager","doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageResult","doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderError"],"anchor":"Core-Types","title":"Core Types"},{"identifiers":["doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/GettingStarted","doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/Configuration"],"anchor":"Related","title":"Related"}],"schemaVersion":{"patch":0,"minor":3,"major":0},"primaryContentSections":[{"kind":"content","content":[{"type":"heading","level":2,"text":"Overview","anchor":"Overview"},{"type":"paragraph","inlineContent":[{"text":"ImageDownloader is built with Swift concurrency, offering clean async\/await APIs alongside traditional completion handlers. All async methods are available on iOS 13.0+ and macOS 10.15+.","type":"text"}]},{"type":"heading","level":2,"text":"Basic Usage","anchor":"Basic-Usage"},{"type":"heading","level":3,"text":"Simple Image Request","anchor":"Simple-Image-Request"},{"type":"codeListing","syntax":"swift","code":["import ImageDownloader","","func loadImage() async {","    do {","        let result = try await ImageDownloaderManager.shared.requestImage(at: imageURL)","        imageView.image = result.image","","        \/\/ Check source","        if result.fromCache {","            print(\"✓ Loaded from memory cache\")","        } else if result.fromStorage {","            print(\"✓ Loaded from disk storage\")","        } else {","            print(\"✓ Downloaded from network\")","        }","    } catch {","        print(\"Error: \\(error)\")","    }","}"]},{"type":"heading","level":3,"text":"With Progress Tracking","anchor":"With-Progress-Tracking"},{"type":"codeListing","syntax":"swift","code":["func loadImageWithProgress() async {","    do {","        let result = try await ImageDownloaderManager.shared.requestImage(","            at: imageURL,","            priority: .high,","            progress: { progress in","                \/\/ Called on main queue","                self.progressView.progress = Float(progress)","                print(\"Progress: \\(Int(progress * 100))%\")","            }","        )","","        imageView.image = result.image","    } catch {","        handleError(error)","    }","}"]},{"type":"heading","level":2,"text":"Error Handling","anchor":"Error-Handling"},{"type":"heading","level":3,"text":"Typed Errors","anchor":"Typed-Errors"},{"type":"paragraph","inlineContent":[{"type":"text","text":"All async methods throw "},{"identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderError","type":"reference","isActive":true},{"type":"text","text":" for precise error handling:"}]},{"type":"codeListing","syntax":"swift","code":["do {","    let result = try await manager.requestImage(at: url)","    imageView.image = result.image","} catch let error as ImageDownloaderError {","    switch error {","    case .invalidURL:","        showError(\"Invalid image URL\")","","    case .networkError(let underlyingError):","        showError(\"Network failed: \\(underlyingError.localizedDescription)\")","","    case .decodingFailed:","        showError(\"Could not decode image\")","","    case .cancelled:","        print(\"Download cancelled\")","","    case .timeout:","        showError(\"Request timed out\")","","    case .notFound:","        showError(\"Image not found\")","","    case .unknown(let underlyingError):","        showError(\"Unknown error: \\(underlyingError.localizedDescription)\")","    }","}"]},{"type":"heading","level":2,"text":"Task Management","anchor":"Task-Management"},{"type":"heading","level":3,"text":"Cancellation","anchor":"Cancellation"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Use Swift’s "},{"type":"codeVoice","code":"Task"},{"type":"text","text":" for cancellable downloads:"}]},{"type":"codeListing","syntax":"swift","code":["class ImageViewController: UIViewController {","    private var downloadTask: Task<Void, Never>?","","    func startDownload() {","        downloadTask = Task {","            do {","                let result = try await ImageDownloaderManager.shared.requestImage(at: url)","                imageView.image = result.image","            } catch is CancellationError {","                print(\"Download cancelled\")","            } catch {","                handleError(error)","            }","        }","    }","","    func cancelDownload() {","        downloadTask?.cancel()","    }","","    override func viewWillDisappear(_ animated: Bool) {","        super.viewWillDisappear(animated)","        cancelDownload()  \/\/ Auto-cancel on dismiss","    }","}"]},{"type":"heading","level":3,"text":"Multiple Concurrent Downloads","anchor":"Multiple-Concurrent-Downloads"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Download multiple images in parallel:"}]},{"type":"codeListing","syntax":"swift","code":["func loadGallery(urls: [URL]) async {","    await withTaskGroup(of: ImageResult?.self) { group in","        for url in urls {","            group.addTask {","                try? await ImageDownloaderManager.shared.requestImage(at: url)","            }","        }","","        var images: [UIImage] = []","        for await result in group {","            if let result = result {","                images.append(result.image)","            }","        }","","        updateGallery(with: images)","    }","}"]},{"type":"heading","level":2,"text":"Force Reload","anchor":"Force-Reload"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Bypass cache and storage to force network download:"}]},{"type":"codeListing","syntax":"swift","code":["func refreshImage() async {","    do {","        let result = try await ImageDownloaderManager.shared.forceReloadImage(","            at: imageURL,","            priority: .high","        )","        imageView.image = result.image","    } catch {","        handleError(error)","    }","}"]},{"type":"heading","level":2,"text":"Priority-Based Loading","anchor":"Priority-Based-Loading"},{"type":"paragraph","inlineContent":[{"text":"Use priority to control download order:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["\/\/ High priority (loaded first)","Task {","    let heroImage = try await manager.requestImage(","        at: heroURL,","        priority: .high","    )","    heroImageView.image = heroImage.image","}","","\/\/ Low priority (loaded later)","Task {","    let thumbnail = try await manager.requestImage(","        at: thumbnailURL,","        priority: .low","    )","    thumbnailView.image = thumbnail.image","}"]},{"type":"heading","level":2,"text":"Integration with SwiftUI","anchor":"Integration-with-SwiftUI"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Use async\/await directly in SwiftUI views:"}]},{"type":"codeListing","syntax":"swift","code":["import SwiftUI","import ImageDownloader","","struct ContentView: View {","    @State private var image: UIImage?","    let imageURL: URL","","    var body: some View {","        Group {","            if let image = image {","                Image(uiImage: image)","                    .resizable()","                    .aspectRatio(contentMode: .fit)","            } else {","                ProgressView()","            }","        }","        .task {","            do {","                let result = try await ImageDownloaderManager.shared.requestImage(at: imageURL)","                image = result.image","            } catch {","                print(\"Error: \\(error)\")","            }","        }","    }","}"]},{"type":"heading","level":2,"text":"Comparison: Async\/Await vs Completion Handlers","anchor":"Comparison-AsyncAwait-vs-Completion-Handlers"},{"type":"heading","level":3,"text":"Async\/Await (Recommended)","anchor":"AsyncAwait-Recommended"},{"type":"codeListing","syntax":"swift","code":["\/\/ ✅ Clean, readable, easy to follow","do {","    let result = try await manager.requestImage(at: url1)","    imageView1.image = result.image","","    let result2 = try await manager.requestImage(at: url2)","    imageView2.image = result2.image","","    let result3 = try await manager.requestImage(at: url3)","    imageView3.image = result3.image","} catch {","    handleError(error)","}"]},{"type":"heading","level":3,"text":"Completion Handlers (Legacy)","anchor":"Completion-Handlers-Legacy"},{"type":"codeListing","syntax":"swift","code":["\/\/ ⚠️ Callback pyramid, harder to read","manager.requestImage(at: url1) { image1, error1, _, _ in","    if let image1 = image1 {","        self.imageView1.image = image1","","        self.manager.requestImage(at: url2) { image2, error2, _, _ in","            if let image2 = image2 {","                self.imageView2.image = image2","","                self.manager.requestImage(at: url3) { image3, error3, _, _ in","                    if let image3 = image3 {","                        self.imageView3.image = image3","                    }","                }","            }","        }","    }","}"]},{"type":"heading","level":2,"text":"Best Practices","anchor":"Best-Practices"},{"items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Use Task for Cancellation"}],"type":"strong"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["let task = Task { try await downloadImage() }","\/\/ Cancel when needed: task.cancel()"]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Handle Errors Properly"}]}]},{"syntax":"swift","type":"codeListing","code":["catch let error as ImageDownloaderError { \/* Handle *\/ }"]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Leverage Structured Concurrency"}],"type":"strong"}]},{"type":"codeListing","syntax":"swift","code":["async let image1 = manager.requestImage(at: url1)","async let image2 = manager.requestImage(at: url2)","let results = try await [image1, image2]"]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Cancel on Dismiss","type":"text"}]}]},{"type":"codeListing","syntax":"swift","code":["override func viewWillDisappear(_ animated: Bool) {","    downloadTask?.cancel()","}"]}]}],"type":"orderedList"}]}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/imagedownloader\/asyncawait"]}],"metadata":{"roleHeading":"API Collection","modules":[{"name":"ImageDownloader"}],"title":"Async\/Await Support","role":"collectionGroup"},"references":{"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/GettingStarted":{"type":"topic","url":"\/documentation\/imagedownloader\/gettingstarted","role":"article","abstract":[{"text":"Download and cache images with just a few lines of code.","type":"text"}],"identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/GettingStarted","title":"Getting Started","kind":"article"},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader":{"url":"\/documentation\/imagedownloader","abstract":[{"type":"text","text":"A powerful, production-ready Swift image downloading library with advanced caching, async\/await support, and full customization."}],"role":"collection","type":"topic","kind":"symbol","title":"ImageDownloader","identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader"},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/ImageDownloaderManager":{"role":"symbol","type":"topic","abstract":[],"url":"\/documentation\/imagedownloader\/imagedownloadermanager","identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderManager","kind":"symbol","navigatorTitle":[{"text":"ImageDownloaderManager","kind":"identifier"}],"title":"ImageDownloaderManager","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ImageDownloaderManager","kind":"identifier"}]},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/ImageResult":{"identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageResult","role":"symbol","type":"topic","title":"ImageResult","abstract":[{"text":"Result of an image download operation (Swift-only)","type":"text"}],"navigatorTitle":[{"text":"ImageResult","kind":"identifier"}],"url":"\/documentation\/imagedownloader\/imageresult","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ImageResult","kind":"identifier"}],"kind":"symbol"},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/ImageDownloaderError":{"navigatorTitle":[{"text":"ImageDownloaderError","kind":"identifier"}],"title":"ImageDownloaderError","role":"symbol","url":"\/documentation\/imagedownloader\/imagedownloadererror","identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderError","kind":"symbol","type":"topic","abstract":[{"text":"Errors that can occur during image downloading","type":"text"}],"fragments":[{"text":"enum","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ImageDownloaderError","kind":"identifier"}]},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/Configuration":{"kind":"article","identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/Configuration","type":"topic","url":"\/documentation\/imagedownloader\/configuration","role":"collectionGroup","title":"Configuration","abstract":[{"type":"text","text":"Configure ImageDownloader behavior globally or per-request."}]}}}