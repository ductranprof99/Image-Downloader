{"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/AsyncAwait"},"abstract":[{"text":"Use modern Swift concurrency with async\/await APIs.","type":"text"}],"seeAlsoSections":[{"anchor":"Essentials","identifiers":["doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/GettingStarted","doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/Configuration"],"title":"Essentials","generated":true}],"variants":[{"paths":["\/documentation\/imagedownloader\/asyncawait"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"content":[{"type":"heading","text":"Overview","anchor":"Overview","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"ImageDownloader is built with Swift concurrency, offering clean async\/await APIs alongside traditional completion handlers. All async methods are available on iOS 13.0+ and macOS 10.15+."}]},{"type":"heading","text":"Basic Usage","anchor":"Basic-Usage","level":2},{"type":"heading","text":"Simple Image Request","anchor":"Simple-Image-Request","level":3},{"type":"codeListing","syntax":"swift","code":["import ImageDownloader","","func loadImage() async {","    do {","        let result = try await ImageDownloaderManager.shared.requestImage(at: imageURL)","        imageView.image = result.image","","        \/\/ Check source","        if result.fromCache {","            print(\"✓ Loaded from memory cache\")","        } else if result.fromStorage {","            print(\"✓ Loaded from disk storage\")","        } else {","            print(\"✓ Downloaded from network\")","        }","    } catch {","        print(\"Error: \\(error)\")","    }","}"]},{"type":"heading","text":"With Progress Tracking","anchor":"With-Progress-Tracking","level":3},{"type":"codeListing","syntax":"swift","code":["func loadImageWithProgress() async {","    do {","        let result = try await ImageDownloaderManager.shared.requestImage(","            at: imageURL,","            priority: .high,","            progress: { progress in","                \/\/ Called on main queue","                self.progressView.progress = Float(progress)","                print(\"Progress: \\(Int(progress * 100))%\")","            }","        )","","        imageView.image = result.image","    } catch {","        handleError(error)","    }","}"]},{"type":"heading","text":"Error Handling","anchor":"Error-Handling","level":2},{"type":"heading","text":"Typed Errors","anchor":"Typed-Errors","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"All async methods throw "},{"type":"reference","identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderError","isActive":true},{"type":"text","text":" for precise error handling:"}]},{"type":"codeListing","syntax":"swift","code":["do {","    let result = try await manager.requestImage(at: url)","    imageView.image = result.image","} catch let error as ImageDownloaderError {","    switch error {","    case .invalidURL:","        showError(\"Invalid image URL\")","","    case .networkError(let underlyingError):","        showError(\"Network failed: \\(underlyingError.localizedDescription)\")","","    case .decodingFailed:","        showError(\"Could not decode image\")","","    case .cancelled:","        print(\"Download cancelled\")","","    case .timeout:","        showError(\"Request timed out\")","","    case .notFound:","        showError(\"Image not found\")","","    case .unknown(let underlyingError):","        showError(\"Unknown error: \\(underlyingError.localizedDescription)\")","    }","}"]},{"type":"heading","text":"Task Management","anchor":"Task-Management","level":2},{"type":"heading","text":"Cancellation","anchor":"Cancellation","level":3},{"type":"paragraph","inlineContent":[{"text":"Use Swift’s ","type":"text"},{"code":"Task","type":"codeVoice"},{"type":"text","text":" for cancellable downloads:"}]},{"type":"codeListing","syntax":"swift","code":["class ImageViewController: UIViewController {","    private var downloadTask: Task<Void, Never>?","","    func startDownload() {","        downloadTask = Task {","            do {","                let result = try await ImageDownloaderManager.shared.requestImage(at: url)","                imageView.image = result.image","            } catch is CancellationError {","                print(\"Download cancelled\")","            } catch {","                handleError(error)","            }","        }","    }","","    func cancelDownload() {","        downloadTask?.cancel()","    }","","    override func viewWillDisappear(_ animated: Bool) {","        super.viewWillDisappear(animated)","        cancelDownload()  \/\/ Auto-cancel on dismiss","    }","}"]},{"type":"heading","text":"Multiple Concurrent Downloads","anchor":"Multiple-Concurrent-Downloads","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Download multiple images in parallel:"}]},{"type":"codeListing","syntax":"swift","code":["func loadGallery(urls: [URL]) async {","    await withTaskGroup(of: ImageResult?.self) { group in","        for url in urls {","            group.addTask {","                try? await ImageDownloaderManager.shared.requestImage(at: url)","            }","        }","","        var images: [UIImage] = []","        for await result in group {","            if let result = result {","                images.append(result.image)","            }","        }","","        updateGallery(with: images)","    }","}"]},{"type":"heading","text":"Force Reload","anchor":"Force-Reload","level":2},{"type":"paragraph","inlineContent":[{"text":"Bypass cache and storage to force network download:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["func refreshImage() async {","    do {","        let result = try await ImageDownloaderManager.shared.forceReloadImage(","            at: imageURL,","            priority: .high","        )","        imageView.image = result.image","    } catch {","        handleError(error)","    }","}"]},{"type":"heading","text":"Priority-Based Loading","anchor":"Priority-Based-Loading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Use priority to control download order:"}]},{"type":"codeListing","syntax":"swift","code":["\/\/ High priority (loaded first)","Task {","    let heroImage = try await manager.requestImage(","        at: heroURL,","        priority: .high","    )","    heroImageView.image = heroImage.image","}","","\/\/ Low priority (loaded later)","Task {","    let thumbnail = try await manager.requestImage(","        at: thumbnailURL,","        priority: .low","    )","    thumbnailView.image = thumbnail.image","}"]},{"type":"heading","text":"Integration with SwiftUI","anchor":"Integration-with-SwiftUI","level":2},{"type":"paragraph","inlineContent":[{"text":"Use async\/await directly in SwiftUI views:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["import SwiftUI","import ImageDownloader","","struct ContentView: View {","    @State private var image: UIImage?","    let imageURL: URL","","    var body: some View {","        Group {","            if let image = image {","                Image(uiImage: image)","                    .resizable()","                    .aspectRatio(contentMode: .fit)","            } else {","                ProgressView()","            }","        }","        .task {","            do {","                let result = try await ImageDownloaderManager.shared.requestImage(at: imageURL)","                image = result.image","            } catch {","                print(\"Error: \\(error)\")","            }","        }","    }","}"]},{"type":"heading","text":"Comparison: Async\/Await vs Completion Handlers","anchor":"Comparison-AsyncAwait-vs-Completion-Handlers","level":2},{"type":"heading","text":"Async\/Await (Recommended)","anchor":"AsyncAwait-Recommended","level":3},{"type":"codeListing","syntax":"swift","code":["\/\/ ✅ Clean, readable, easy to follow","do {","    let result = try await manager.requestImage(at: url1)","    imageView1.image = result.image","","    let result2 = try await manager.requestImage(at: url2)","    imageView2.image = result2.image","","    let result3 = try await manager.requestImage(at: url3)","    imageView3.image = result3.image","} catch {","    handleError(error)","}"]},{"type":"heading","text":"Completion Handlers (Legacy)","anchor":"Completion-Handlers-Legacy","level":3},{"type":"codeListing","syntax":"swift","code":["\/\/ ⚠️ Callback pyramid, harder to read","manager.requestImage(at: url1) { image1, error1, _, _ in","    if let image1 = image1 {","        self.imageView1.image = image1","","        self.manager.requestImage(at: url2) { image2, error2, _, _ in","            if let image2 = image2 {","                self.imageView2.image = image2","","                self.manager.requestImage(at: url3) { image3, error3, _, _ in","                    if let image3 = image3 {","                        self.imageView3.image = image3","                    }","                }","            }","        }","    }","}"]},{"type":"heading","text":"Best Practices","anchor":"Best-Practices","level":2},{"items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Use Task for Cancellation"}],"type":"strong"}],"type":"paragraph"},{"code":["let task = Task { try await downloadImage() }","\/\/ Cancel when needed: task.cancel()"],"syntax":"swift","type":"codeListing"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Handle Errors Properly","type":"text"}]}]},{"code":["catch let error as ImageDownloaderError { \/* Handle *\/ }"],"type":"codeListing","syntax":"swift"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Leverage Structured Concurrency"}]}],"type":"paragraph"},{"code":["async let image1 = manager.requestImage(at: url1)","async let image2 = manager.requestImage(at: url2)","let results = try await [image1, image2]"],"syntax":"swift","type":"codeListing"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Cancel on Dismiss"}],"type":"strong"}]},{"syntax":"swift","type":"codeListing","code":["override func viewWillDisappear(_ animated: Bool) {","    downloadTask?.cancel()","}"]}]}],"type":"orderedList"}],"kind":"content"}],"schemaVersion":{"major":0,"minor":3,"patch":0},"kind":"article","sections":[],"metadata":{"role":"collectionGroup","title":"Async\/Await Support","roleHeading":"API Collection","modules":[{"name":"ImageDownloader"}]},"topicSections":[{"anchor":"Core-Types","identifiers":["doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderManager","doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageResult","doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderError"],"title":"Core Types"},{"anchor":"Related","identifiers":["doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/GettingStarted","doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/Configuration"],"title":"Related"}],"hierarchy":{"paths":[["doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader"]]},"references":{"doc://image-downloader.ImageDownloader/documentation/ImageDownloader":{"url":"\/documentation\/imagedownloader","type":"topic","abstract":[{"text":"A powerful, production-ready Swift image downloading library with advanced caching, async\/await support, and full customization.","type":"text"}],"identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader","title":"ImageDownloader","kind":"symbol","role":"collection"},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/ImageResult":{"role":"symbol","url":"\/documentation\/imagedownloader\/imageresult","identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageResult","kind":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ImageResult","kind":"identifier"}],"navigatorTitle":[{"text":"ImageResult","kind":"identifier"}],"abstract":[{"text":"Result of an image download operation (Swift-only)","type":"text"}],"type":"topic","title":"ImageResult"},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/GettingStarted":{"identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/GettingStarted","title":"Getting Started","url":"\/documentation\/imagedownloader\/gettingstarted","abstract":[{"type":"text","text":"Download and cache images with just a few lines of code."}],"kind":"article","role":"article","type":"topic"},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/ImageDownloaderManager":{"navigatorTitle":[{"text":"ImageDownloaderManager","kind":"identifier"}],"url":"\/documentation\/imagedownloader\/imagedownloadermanager","type":"topic","identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderManager","abstract":[],"title":"ImageDownloaderManager","kind":"symbol","role":"symbol","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ImageDownloaderManager","kind":"identifier"}]},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/Configuration":{"title":"Configuration","abstract":[{"type":"text","text":"Configure ImageDownloader behavior globally or per-request."}],"identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/Configuration","type":"topic","role":"collectionGroup","kind":"article","url":"\/documentation\/imagedownloader\/configuration"},"doc://image-downloader.ImageDownloader/documentation/ImageDownloader/ImageDownloaderError":{"url":"\/documentation\/imagedownloader\/imagedownloadererror","title":"ImageDownloaderError","type":"topic","kind":"symbol","abstract":[{"type":"text","text":"Errors that can occur during image downloading"}],"identifier":"doc:\/\/image-downloader.ImageDownloader\/documentation\/ImageDownloader\/ImageDownloaderError","fragments":[{"kind":"keyword","text":"enum"},{"kind":"text","text":" "},{"kind":"identifier","text":"ImageDownloaderError"}],"navigatorTitle":[{"kind":"identifier","text":"ImageDownloaderError"}],"role":"symbol"}}}